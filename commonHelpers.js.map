{"version":3,"file":"commonHelpers.js","sources":["../src/img/symbol-defs.svg","../src/js/shoppinglist.js","../src/card.js"],"sourcesContent":["export default \"__VITE_ASSET__1950cb8b__\"","import { renderTitle } from '../js/Services/helpers';\nimport localStorageBooks from '../js/localstorage';\nimport sprite from '../img/symbol-defs.svg';\nimport amazon from '../img/amazon-n.png';\nimport apple from '../img/apple-n.png';\nimport { updateBooksCounter } from './updatecounter';\n\nconst shoppingList = document.querySelector('.cart-list');\nconst cartEmptyMsg = document.querySelector('.cart-empty-container');\nconst paginationList = document.querySelector('.pagination-list');\nconst buttonsContainer = document.querySelector('.cart-buttons-container');\n\nrenderTitle('.shoppinglist-title', 'Shopping List');\nfunction renderShoppingList(books) {\n  shoppingList.innerHTML = '';\n  const hmtlBookList = books\n    .map(book => {\n      return `<li class=\"cart-item\">\n      <img\n        class=\"cart-item-img\"\n        src=\"${book.book_image}\"\n        alt=\"book image\"\n        width=\"100\"\n        height=\"142\"\n      />\n      <div class=\"cart-item-content\">\n        <div class=\"cart-item-content-top\">\n          <div class=\"cart-item-content-top-left\">\n            <h3 class=\"cart-item-title\">${book.title}</h3>\n            <p class=\"cart-item-category\">${book.list_name}</p>\n          </div>\n          <button data-id=\"${book._id}\" class=\"cart-item-del-button\">\n            <svg class=\"cart-item-del-button-icon\" width=\"12\" height=\"12\">\n\n              <use href=\"${sprite}#icon-delete-shoppinglist-tab\" />\n            </svg>\n          </button>\n        </div>\n        <div class=\"cart-item-content-middle\">\n          <p class=\"cart-item-content-desc\">\n            ${book.description}\n          </p>\n          <div class=\"cart-item-content-bottom\">\n            <p class=\"cart-item-author\">${book.author}</p>\n            <div class=\"cart-items-links\">\n              <a\n                class=\"cart-items-link\"\n                target=\"_blank\"\n                href=\"${book.amazon_buy_link}\"\n              >\n                <img\n                  class=\"cart-items-amazon\"\n                  src=\"${amazon}\"\n                  alt=\"shopping cart empty\"\n                  height=\"11\"\n                  width=\"32\"\n                />\n              </a>\n              <a\n                class=\"cart-items-link\"\n                target=\"_blank\"\n                href=\"${book.apple_buy_link}\"\n              >\n                <img\n                  class=\"cart-items-apple\"\n\n                  src=\"${apple}\"\n                  alt=\"shopping cart empty\"\n                  height=\"16\"\n                  width=\"16\"\n                />\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n    </li>`;\n    })\n    .join('');\n  shoppingList.insertAdjacentHTML('beforeend', hmtlBookList);\n}\n\nlet pageData = {\n  books: [],\n  currentPage: 0,\n  nextPage: 0,\n  prevPage: 0,\n  totalBooks: 0,\n  totalPages: 0,\n  booksPerPage: 0,\n  buttonsPerPage: 0,\n  totalButtonsGroups: 0,\n  pagesOnLastGroup: 0,\n};\n\nfunction renderShoppingListPage(pageData) {\n  paginationList.removeEventListener('click', buttonClickHandler);\n  shoppingList.removeEventListener('click', removeBookFromList);\n  const books = localStorageBooks.getAllBooks();\n  shoppingList.innerHTML = '';\n  paginationList.innerHTML = '';\n  pageData.totalBooks = books.length;\n  pageData.booksPerPage = getBooksPerPage();\n  pageData.totalPages = getTotalPages(\n    pageData.totalBooks,\n    pageData.booksPerPage\n  );\n  pageData.books = createBooksListsPerPage(\n    books,\n    pageData.booksPerPage,\n    pageData.totalPages\n  );\n  pageData.buttonsPerPage = getButtonsPerPage();\n  pageData.totalButtonsGroups = Math.ceil(\n    pageData.totalPages / pageData.buttonsPerPage\n  );\n\n  pageData.pagesOnLastGroup = pageData.totalPages % pageData.totalButtonsGroups;\n\n  if (pageData.totalBooks > 0) {\n    if (pageData.totalPages === 1) {\n      renderShoppingList(pageData.books[0]);\n    }\n\n    if (pageData.totalPages > 1) {\n      renderShoppingList(pageData.books[pageData.currentPage]);\n      renderPaginationButtons(pageData, paginationList);\n      makeActiveButton(pageData.currentPage);\n      const currentButton = document.querySelector('.active');\n      moveButtonToCenter(currentButton);\n      paginationList.addEventListener('click', buttonClickHandler);\n    }\n    shoppingList.addEventListener('click', removeBookFromList);\n  } else {\n    cartEmptyMsg.classList.remove('is-hidden');\n  }\n}\n\nfunction renderPaginationButtons(pageData, paginationList) {\n  paginationList.innerHTML = '';\n\n  if (pageData.totalPages > 1) {\n    for (let i = 0; i < pageData.totalPages; i++) {\n      paginationList.insertAdjacentHTML(\n        'beforeend',\n        `<li><button data-page=\"${i}\">${i + 1}</button></li>`\n      );\n    }\n  }\n}\n\nfunction buttonClickHandler(e) {\n  const clickedElement = e.target.closest('button');\n  if (clickedElement) {\n    const pageButton = clickedElement.dataset.page;\n    if (pageButton) {\n      renderShoppingList(pageData.books[pageButton]);\n      makeActiveButton(pageButton);\n      pageData.currentPage = pageButton;\n      moveButtonToCenter(clickedElement);\n    }\n  }\n}\n\nfunction moveButtonToCenter(clickedElement) {\n  const buttonSize = clickedElement.getBoundingClientRect();\n  const containerSize = buttonsContainer.getBoundingClientRect();\n  const sliderSize = paginationList.getBoundingClientRect();\n\n  const centerOfContainer = containerSize.width / 2;\n  const centerOfButton = buttonSize.width / 2;\n  const buttonPosition = buttonSize.left;\n  const sliderPosition = sliderSize.left;\n\n  const moveTo =\n    parseInt(centerOfContainer) -\n    parseInt(buttonPosition) -\n    parseInt(centerOfButton) +\n    parseInt(sliderPosition);\n  paginationList.style.translate = `${moveTo}px 0`;\n}\n\nfunction removeBookFromList(e) {\n  if (e.target.closest('.cart-item-del-button') !== null) {\n    const bookId = e.target.closest('.cart-item-del-button').dataset.id;\n    localStorageBooks.removeBookFromFavorites(bookId);\n    updateBooksCounter();\n    if (\n      parseInt(pageData.currentPage) === parseInt(pageData.totalPages) - 1 &&\n      pageData.books[pageData.currentPage].length === 1\n    ) {\n      if (pageData.currentPage >= 1) {\n        pageData.currentPage -= 1;\n      }\n    }\n    renderShoppingListPage(pageData);\n  }\n}\n\nfunction isMobile() {\n  const windowWidth = window.innerWidth;\n  return windowWidth < 767;\n}\n\nfunction getBooksPerPage() {\n  return isMobile() ? 4 : 3;\n}\n\nfunction getButtonsPerPage() {\n  return isMobile() ? 2 : 3;\n}\n\nfunction getTotalPages(totalBooks, booksPerPage) {\n  return Math.ceil(totalBooks / booksPerPage);\n}\n\nfunction makeActiveButton(currentPage) {\n  const currentButton = document.querySelector('.active');\n  currentButton?.classList.remove('active');\n  const activeButton = document.querySelector(`[data-page=\"${currentPage}\"]`);\n  activeButton.classList.add('active');\n}\n\nfunction createBooksListsPerPage(books, booksPerPage, totalPages) {\n  let booksPages = [];\n  for (let i = 0; i < totalPages; i++) {\n    booksPages[i] = books.splice(0, booksPerPage);\n  }\n  return booksPages;\n}\n\n// for (let i = 0; i < 60; i++) {\n//   const book = {\n//     _id: `${i}`,\n//     title: `${i}`,\n//     author: 'Michelle Zauner',\n//     list_name: 'Paperback Nonfiction',\n//     book_image:\n//       'https://storage.googleapis.com/du-prd/books/images/9780525657743.jpg',\n//     description:\n//       'The daughter of a Korean mother and Jewish American father, and leader of the indie rock project Japanese Breakfast, describes creating her own identity after losing her mother to cancer.',\n//     amazon_buy_link: 'https://www.amazon.com/dp/0593379853?tag=NYTBSREV-20',\n//     apple_buy_link: 'https://goto.applebooks.apple/9781984896391?at=10lIEQ',\n//   };\n\n//   localStorageBooks.addBookToFavorites(book);\n// }\n\nrenderShoppingListPage(pageData);\n","import './js/shoppinglist';\nimport './js/header';\nimport './js/support';\nimport './js/Services/api';\nimport './js/Services/helpers';\nimport './js/localstorage';\n\nimport { updateBooksCounter } from './js/updatecounter';\n\nupdateBooksCounter();\n"],"names":["sprite","shoppingList","cartEmptyMsg","paginationList","buttonsContainer","renderTitle","renderShoppingList","books","hmtlBookList","book","amazon","apple","pageData","renderShoppingListPage","buttonClickHandler","removeBookFromList","localStorageBooks","getBooksPerPage","getTotalPages","createBooksListsPerPage","getButtonsPerPage","renderPaginationButtons","makeActiveButton","currentButton","moveButtonToCenter","i","e","clickedElement","pageButton","buttonSize","containerSize","sliderSize","centerOfContainer","centerOfButton","buttonPosition","sliderPosition","moveTo","bookId","updateBooksCounter","isMobile","totalBooks","booksPerPage","currentPage","totalPages","booksPages"],"mappings":"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"}